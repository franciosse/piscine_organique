{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///media/franciosse/Data/Repos/piscine_organique/app/%5Blocale%5D/components/admin/courseEditor.tsx"],"sourcesContent":["\n// components/admin/CourseEditor.tsx\n'use client';\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { Course, CourseChapter, Lesson } from '@/lib/db/schema';\n\ninterface CourseWithDetails extends Course {\n  chapters: (CourseChapter & {\n    lessons: Lesson[];\n  })[];\n}\n\ninterface CourseEditorProps {\n  courseId: number;\n}\n\nexport default function CourseEditor({ courseId }: CourseEditorProps) {\n  const [course, setCourse] = useState<CourseWithDetails | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string>('');\n\n  useEffect(() => {\n    fetchCourse();\n  }, [courseId]);\n\n  const fetchCourse = async () => {\n    try {\n      const response = await fetch(`/api/admin/courses/${courseId}`);\n      const data = await response.json();\n      \n      if (response.ok) {\n        setCourse(data.course);\n      } else {\n        setError(data.error || 'Erreur lors du chargement');\n      }\n    } catch (err) {\n      setError('Erreur de connexion');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const toggleCoursePublication = async () => {\n    if (!course) return;\n\n    try {\n      const response = await fetch(`/api/admin/courses/${courseId}`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          published: course.published ? null : new Date().toISOString(),\n        }),\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        setCourse(prev => prev ? { ...prev, published: data.course.published } : null);\n      }\n    } catch (err) {\n      setError('Erreur lors de la mise à jour');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center min-h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (error || !course) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg\">\n        {error || 'Cours non trouvé'}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* En-tête du cours */}\n      <div className=\"bg-white shadow rounded-lg p-6\">\n        <div className=\"flex justify-between items-start\">\n          <div className=\"flex-1\">\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">{course.title}</h1>\n            <p className=\"text-gray-600 mb-4\">{course.description}</p>\n            <div className=\"flex items-center space-x-4 text-sm text-gray-500\">\n              <span>Prix: {(course.price / 100).toFixed(2)} €</span>\n              <span>Niveau: {course.difficultyLevel}</span>\n              {course.estimatedDuration && (\n                <span>Durée: {course.estimatedDuration} min</span>\n              )}\n            </div>\n          </div>\n          <div className=\"flex space-x-2\">\n            <Link\n              href={`/admin/courses/${courseId}/edit`}\n              className=\"px-4 py-2 text-blue-600 border border-blue-600 rounded-lg hover:bg-blue-50 transition-colors\"\n            >\n              Modifier\n            </Link>\n            <button\n              onClick={toggleCoursePublication}\n              className={`px-4 py-2 rounded-lg transition-colors ${\n                course.published\n                  ? 'bg-red-600 text-white hover:bg-red-700'\n                  : 'bg-green-600 text-white hover:bg-green-700'\n              }`}\n            >\n              {course.published ? 'Dépublier' : 'Publier'}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Contenu du cours */}\n      <div className=\"bg-white shadow rounded-lg p-6\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h2 className=\"text-xl font-semibold\">Contenu du cours</h2>\n          <Link\n            href={`/admin/courses/${courseId}/chapters/new`}\n            className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors\"\n          >\n            + Ajouter un chapitre\n          </Link>\n        </div>\n\n        {course.chapters.length === 0 ? (\n          <div className=\"text-center py-12 text-gray-500\">\n            <p className=\"mb-4\">Aucun chapitre créé pour ce cours</p>\n            <Link\n              href={`/admin/courses/${courseId}/chapters/new`}\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors\"\n            >\n              Créer le premier chapitre\n            </Link>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {course.chapters\n              .sort((a, b) => a.position - b.position)\n              .map((chapter, index) => (\n                <div key={chapter.id} className=\"border border-gray-200 rounded-lg p-4\">\n                  <div className=\"flex justify-between items-start mb-2\">\n                    <div>\n                      <h3 className=\"font-medium text-gray-900\">\n                        {index + 1}. {chapter.title}\n                      </h3>\n                      {chapter.description && (\n                        <p className=\"text-sm text-gray-600 mt-1\">{chapter.description}</p>\n                      )}\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                      <span className={`text-xs px-2 py-1 rounded-full ${\n                        chapter.published\n                          ? 'bg-green-100 text-green-800'\n                          : 'bg-gray-100 text-gray-800'\n                      }`}>\n                        {chapter.published ? 'Publié' : 'Brouillon'}\n                      </span>\n                      <Link\n                        href={`/admin/chapters/${chapter.id}/edit`}\n                        className=\"text-sm text-blue-600 hover:text-blue-900\"\n                      >\n                        Modifier\n                      </Link>\n                    </div>\n                  </div>\n\n                  {/* Leçons du chapitre */}\n                  <div className=\"ml-4 mt-3 space-y-2\">\n                    {chapter.lessons\n                      .sort((a, b) => a.position - b.position)\n                      .map((lesson, lessonIndex) => (\n                        <div key={lesson.id} className=\"flex justify-between items-center py-2 px-3 bg-gray-50 rounded\">\n                          <div className=\"flex items-center space-x-2\">\n                            <span className=\"text-sm text-gray-500\">\n                              {index + 1}.{lessonIndex + 1}\n                            </span>\n                            <span className=\"text-sm\">{lesson.title}</span>\n                            {lesson.duration && (\n                              <span className=\"text-xs text-gray-500\">\n                                ({Math.floor(lesson.duration / 60)}:{(lesson.duration % 60).toString().padStart(2, '0')})\n                              </span>\n                            )}\n                          </div>\n                          <div className=\"flex items-center space-x-2\">\n                            <span className={`text-xs px-2 py-1 rounded-full ${\n                              lesson.published\n                                ? 'bg-green-100 text-green-800'\n                                : 'bg-gray-100 text-gray-800'\n                            }`}>\n                              {lesson.published ? 'Publié' : 'Brouillon'}\n                            </span>\n                            <Link\n                              href={`/admin/lessons/${lesson.id}/edit`}\n                              className=\"text-xs text-blue-600 hover:text-blue-900\"\n                            >\n                              Modifier\n                            </Link>\n                          </div>\n                        </div>\n                      ))}\n                    \n                    <Link\n                      href={`/admin/chapters/${chapter.id}/lessons/new`}\n                      className=\"inline-flex items-center text-sm text-blue-600 hover:text-blue-900 py-2 px-3\"\n                    >\n                      + Ajouter une leçon\n                    </Link>\n                  </div>\n                </div>\n              ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 462, "column": 0}, "map": {"version":3,"sources":["file:///media/franciosse/Data/Repos/piscine_organique/app/%5Blocale%5D/%28dashboard%29/dashboard/admin/courses/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\nimport React, { useState } from 'react';\nimport { useParams } from 'next/navigation';\nimport CourseEditor from '@/app/[locale]/components/admin/courseEditor';\n\nexport default function CoursePage() {\n  const { id } = useParams(); \n  const courseId = Number(id);\n  return (\n    <section className=\"flex-1 p-4 lg:p-8\">\n      <h1 className=\"text-lg lg:text-2xl font-medium text-gray-900 mb-6\">\n        Course Administration\n      </h1>\n\n        <div className=\"mt-8\">\n          <CourseEditor courseId={courseId}></CourseEditor>\n        </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;;;AAHA;;;AAKe,SAAS;;IACtB,MAAM,EAAE,EAAE,EAAE,GAAG,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,WAAW,OAAO;IACxB,qBACE,6LAAC;QAAQ,WAAU;;0BACjB,6LAAC;gBAAG,WAAU;0BAAqD;;;;;;0BAIjE,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,4JAAA,CAAA,UAAY;oBAAC,UAAU;;;;;;;;;;;;;;;;;AAIlC;GAdwB;;QACP,qIAAA,CAAA,YAAS;;;KADF","debugId":null}}]
}